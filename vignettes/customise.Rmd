---
title: "Customise your website"
output: rmarkdown::html_vignette
description: >
  Learn how to change the look and feel of pkgdown websites.
vignette: >
  %\VignetteIndexEntry{Customise your website}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(pkgdown)
```

You can alter the design/styling of your pkgdown website to suit your brand and needs.
There are two main techniques:

-   **Theming** changes colours, fonts, spacing etc. using a Bootswatch template, Bootstrap variables, Bootstrap rules, or custom CSS.

-   **Layout** changes the content (or ordering) of e.g. the navbar, authors page, or `<head>` tag, by using pkgdown options or templates.

This vignette begins with a discussion of the most common theming and layout options made available through `_pkgdown.yml`.
We'll then discuss how to customise the underlying HTML template files, this is less commonly needed but gives you full control over the appearance of the website.
Next, we'll discuss how to give multiple sites the same style by using a package, and we'll finish up with some workflow advice.

## Getting started

Most theming features work only with Bootstrap 5, so begin by updating your site to use Bootstrap 5 by adding the following lines to your `_pkgdown.yml`:

``` yaml
template:
  bootstrap: 5
```

Overall, the site should look pretty similar, but you should notice a number of small improvements; most importantly the default font is much bigger, making it considerably easier to read.
Upgrading to Bootstrap 5 has a low chance of breaking your site, but if you were managing your [own pkgdown templates](#layout) or using custom CSS, you might need to tweak a few files.

## Theming

There are three main ways to change the visual style of your site:

-   With a pre-packaged bootswatch theme.

-   By customising theme variables via bslib.

-   With your own CSS and JS.

They can be combined depending on your needs.

### Bootswatch themes

The easiest way to change the entire appearance of your website is to use a [Bootswatch theme](https://bootswatch.com):

``` yaml
template:
  bootstrap: 5
  bootswatch: materia
```

Changing the bootswatch theme affects both the HTML (via the navbar, more on that below) and the CSS, so you'll need to re-build your complete site with `build_site()` to fully appreciate the changes.
While you're initially experimenting, you can speed things up by just rebuilding the home page and the css by running `build_home_index(); init_site()`.

Bootswatch templates with tall navbars (like lux or pulse) also require that you set the `pkgdown-nav-height` bslib variable:

``` yaml
template:
  bootstrap: 5
  bootswatch: lux
  bslib:
    pkgdown-nav-height: 100px
```

I found the height of the navbar using the developer console.

### bslib variables

Instead of picking a complete theme, you can also tweak fonts and colours individually using bslib variables.
[bslib](https://rstudio.github.io/bslib/) is an R package that wraps sass, the tool that Boostrap uses to produce css from a special language called [scss](https://sass-lang.com).
The primary advantage of scss over css is that it more programmable, so you can have a few key variables that affect appearance of many HTML elements.

``` yaml
template:
  bootstrap: 5
  bslib:
    bg: "#202123"
    fg: "#B8BCC2"
```

There are three key variables for setting colour:

-   `bg` (background) determines the page background.
-   `fg` (foreground) determines the text colour.
-   `primary` sets the link colour, and is mixed with the page background to yield the hover colour in the navbar and sidebar.

`bg` and `fg` are mixed to yield `gray-100`, `gray-200`, ..., `grey-900`, which are used to style other elements to match the overall colour scheme.

If you want to move away from these defaults, you'll need to set more specific bootstrap variables, taking advantage of inheritance where possible.
For example, `table-border-color` defaults to `border-color` which defaults to `gray-300`.
If you want to change the colour of all border, you can set `border-color`; if you just want to change the colour of table borders, you can set `table-border-color`.
You can find a full list of variables in `vignette("bs5-variables", package = "bslib")`.

You can also override the default fonts.
The easiest way is to supply the name of a [Google font](https://fonts.google.com):

``` yaml
template:
  bootstrap: 5
  bslib:
    base_font:
      google: "Prompt"
    heading_font:
      google: "Muli"
    code_font:
      google: "JetBrains Mono"
```

While iterating on bslib variables you only need to rerun `init_site()` and refresh your browser.

### Navbar style

The primary navbar colours are determined by HTML classes, not CSS, and can be customized using the `bg` and `type` `navbar` parameters.
Typically `bg` will be one of `light`, `dark` or `primary`:

``` yaml
navbar:
  bg: primary
```

You generally don't need to set `bg` if you use a bootswatch theme, as pkgdown will pick the `bg` used on the [Bootstwatch preview](https://bootswatch.com/).

The type argument determines the colour of the text.
Use `type: light` if the background is light (so you need dark text) or `type: dark` if the background is dark (so you need light text).
pkgdown will guess if you don't supply this argument.

Because the navbar is styled with HTML, you'll need to `build_site()`/`build_home_index()` to see the effect of changing this parameter.

### Custom CSS and JS

If you know CSS or JS, you can customise your site by including `pkgdown/extra.css` or `pkgdown/extra.js`.
These will be automatically copied the home directory of your website and inserted into the `<head>` (after the pkgdown defaults).

You can add arbitrary additional files by putting them in `pkgdown/assets/BS5`.
The contents will be automatically copied to the root of your website folder by pkgdown by `init_site()`.

## Layout {#layout}

You can also customise the contents of the navbar, footer, and home page sidebar.
They all use a similar structure separately defining the `structure` from the `components`.

### Navbar

```{r child="../man/rmd-fragments/navbar-configuration.Rmd"}
```

### Footer

```{r child="../man/rmd-fragments/footer-configuration.Rmd"}
```

### Sidebar

```{r child = "../man/rmd-fragments/sidebar-configuration.Rmd"}
```

## Templates

Other layout changes require tinkering with pkgdown **templates** (in `inst/templates` in [pkgdown source](https://github.com/r-lib/pkgdown)).
Three pkgdown templates are empty by default, so you can fill them with your own content:

-   `in-header.html` is inserted right before closing the head tag.
-   `before-body.html` is inserted right after opening the body tag.
-   `after-body.html` is inserted right before closing the body tag.

To add content to these templates:

-   Create a folder `pkgdown/templates`.
-   Create `in-header.html`, `before-body.html` or `after-body.html` in that folder, depending on your needs. E.g. you could save the lines corresponding to your analytics provider, if not Google Analytics, in `pkgdown/templates/in-header.html`.
-   Edit and save that file.
-   Re-build your website, inspect it (and its source, if needed).

It is possible to customise other templates but this is recommended for advanced users only because you'll need to keep it up to date as pkgdown itself changes.
If you've used `head.html` in the past, we now recommend switching to using `in-header.html` instead.
A limitation to tweaking templates is that your templates can only access data that pkgdown specifically supplies; you can learn more in the documentation and source code of `render_page()`.

## Template packages

To share a pkgdown style across several packages, the best workflow is to create... a package!
It can contain any of the following:

-   A configuration file in `inst/pkgdown/_pkgdown.yml`. This can be used to set (e.g.) author definitions, Bootstrap version and variables, the sidebar, footer, navbar, etc. Configuration parameters supplied by a template package have low priority: they will be overridden by a local `_pkgdown.yml` which is in turn overridden by `override` parameter of `build_site()`.
-   Templates in `inst/pkgdown/templates/` will override the default templates.
-   Assets in `inst/pkgdown/assets/` will be copied in to the destination directory.

Once you have created your template package `theverybest`, you can use it by:

-   Setting it as your sites theme:

    ``` yaml
    template:
      package: theverybest
    ```

-   If you're building your site using GitHub actions or other similar tool, you'll also need to installed `theverybest`.
    If you're using remotes or pak to install packages, you can add the following line to your `DESCRIPTION`:

        Config/Needs/website: theverybest

To get some sense of how a theming package works you can look at:

-   [tidytemplate](https://tidytemplate.tidyverse.org/) used for tidyverse and tidymodels packages;
-   [quillt](https://pkgs.rstudio.com/quillt) used for R Markdown packages;
-   [rotemplate](https://github.com/ropensci-org/rotemplate) used for rOpenSci packages.

But please note that these templates aren't suitable for use with your own package as they're all designed to give a common visual identity to a specific family of packages.

## PR previews

Lastly it might be useful for you to get a preview of the website in internal pull requests.
For that, you could use Netlify and GitHub Actions (or apply a similar logic to your toolset):

-   create a new Netlify website (either from scratch by dragging and dropping a simple index.html, or by creating a site from a GitHub repository and then unlinking that repository); from the site settings get its ID to be saved as `NETLIFY_SITE_ID` in your repo secrets; from your account developer settings get a token to be saved as `NETLIFY_TOKEN` in your repo secrets.
-   starting from the standard pkgdown workflow `usethis::use_github_action("pkgdown")`, add some logic to build the site and deploy it to Netlify for pull requests from inside the repository, not pull requests from forks. [Example workflow](https://github.com/r-lib/pkgdown/blob/master/.github/workflows/pkgdown.yaml).

## Conclusion

In this vignette we explained how to change the theming and layout of pkgdown websites.
Further work to improve user experience is:

-   Working on the article (`?build_articles`) and reference indexes (`?build_reference`).
-   Writing a compelling README that explains why your package is so cool/useful/fun.
-   Improving the contents of the individual articles and reference topics 😉.
